## 介绍

### 自我介绍

面试官你好，我叫权大玮，今天24岁，目前是在西安的西北大学研三，我本科也是在西北大学，专业都是软件工程。**实验室方向是带宽调度，做的是研究数据中心网络中的传输请求的调度策略，主要是就基于高性能网络领域里面一些比较经典模型，去设计新的调度策略和路由策略，我这里结合一些线性规划，去优化实时传输上的性能。**平时用的相对多的编程语言就是java，目标工作岗位就是java开发，数据库相对熟悉的就是MySQL。在北京的小米金融有三个多月的实习，岗位就是后端开发。主要参与开发的项目就是金融APP的后端和APP的CMS内容管理系统的后端，当时的任务主要是做接口的兼容和业务的新需求。

我家是天津，老家是山西，因为我在西安也上学呆了7年了，也有点感情，希望以后能留在西安在西安发展。

My name is Quan Dawei, 24 years old today。i come from tianjin。im a Graduate student at Northwest University in xian。My major is software enginiiering. I worked as an intern in Xiaomi for 3 months and I learned a lot.Thanks for xiaomi's help.i have been in xian for seven years.I hope to stay in Xi 'an in the future

中兴偏国企，华为偏私企。中兴和华为都是难兄难弟，都被美国制约制裁过

我希望能在工作中能深入到比较通用的工作。

#### 遇到技术困难咋办

1. 先查资料，百度、博客
2. 问同事，看看有没有遇到过，接触过，给一个建议

怎么看待华为

不管是美国制裁还是疫情，今年真的挺难得，希望中国的高科技企业能够挺下来，发展起来，尽早能摆脱尖端科技对外界的依赖，要转型让更多企业走到生产链条的上游，

#### 自己的优势

- 对业务的理解能力比较快，学习能力还算是挺好的。我只能说我现在定位业务中的问题比同事快。
- 我的工作中的态度是比较积极的，有一些潜在问题我会主动推进，跟人去沟融，把这个问题暴露出来，要不然总憋在自己这很不舒服。然后像有些没有解决的事我都会记得很清楚，因为没处理完会觉得之后肯定会更麻烦，所以就希望尽早解决。
- 对有些事比较较真，自己没说服自己之前就总去问。
- 然后我在工作中的交流还是比较有调理的

#### 劣势

我不太会当众说很多，人很多会有点小紧张，尤其是在自己准备了点但是明显不充分的时候。

#### 遇到的挫折

最近的话应该是疫情期间在家里准备找实习的时候，发现需要学的东西越来越多，因为可能当初对整个后端开发的轮廓不是很清晰，然后也低估了做这个岗位的门槛，以为毕竟实习嘛。但是实际上还是欠缺一些专业知识的，所以就一边面一边学，但是到后来的话就是越战越勇了。



#### 未来规划

首先我目前能想到的就是去学习，积累，首先在技术上要真正的扎实，能达到轻松应对业务，分析问题要快要准。其他就是要在编码之外的积累，比如提高处理关系的能力，提高协调事件的能力，然后去学习一些产品相关的知识。

#### 兴趣爱好

- 比较喜欢电子产品，相关的产品评测开箱什么的比较感兴趣，比较关注相关的新闻。
- 对主机游戏和桌游都比较有好感。桌游虽然玩的不多，但是很喜欢不多的几次桌游经历，自己也买了一些入门的作品，和同学在学校偶尔会开个局。桌游有：风声，盗梦都市，犯罪现场，宝石商人（资源管理）。
- 喜欢看电影美剧。还记得的比较喜欢的美剧：生活大爆炸，废柴联盟，守望者，鬼入侵，传教士（坚持，友谊，内疚，反套路，黑色幽默，封测，节奏吸引人）

### 实习项目

项目介绍：我这边是在用户增长部门，研发这边业务主要是，活动后端，给金融app提供数据的后端，提供给运营去编辑app内容的一个平台CMS。

#### 背景

现在要求其他部门的新版app都融合我们这个金融这边的用户增长这边服务，包括每个主tab的内容（首页，个人中心）每个，然后针对每个app都要实现在CMS上的可配置。所以这边主要就两个方面的工作，一个是做这个融合，把不同app上的资源数据隔离出来，然后代码中要丢不同app的需求做区分，各种接口也都要改。二是做这个app新版本的需求和CMS新版本需求，比如app中新的模块，新的可配置的也要去开发CMS。

#### 参与的项目细节

我们这个金融服务的项目，涉及到我这的就是一个是客户端直接调的接口，一个是也要融合到我们之前的CMS系统上。

- 金融app的后端，就是负责app提供页面数据，包括app中的一些运营资源位数据，用户相关信息，这些一般都是调别的业务部门提供的接口，因为这些接口涉及的部门还挺多，要跟他们去沟通。负责提供给数据分析那边的埋点信息。web项目和service层项目用thrift去调用
- CMS，可以通过CMS去增删改APP中的一些模块内容，可以设置模块的一些属性，和一些展示条件、展示顺序。api项目作为web项目提供给前端接口，service层项目操作数据库，通过thrift提供远程调用。调用一个是app的api后端和service后端；一个是CMS系统的api后端和service后端。

- 运营通过CMS系统可以控制APP各个tab页面包括弹窗、开屏、底tab的大部分可配置内容，一般是组件的相对顺序和资源组件的内容。
  - 为一个模块**新增内容**，为内容设置过滤条件和模块自身特殊的配置规则（跳转连接，图片等等）。
  - 更改模块之间的是否显示和**相对顺序**
  - 复制一个内容到其他允许**复制**的模块中
    - 获取内容id对应的内容的模块类型，根据类型从库中查出所有相同类型的模块信息（模块信息可通过模块类型和页面id和appId来确定唯一性），去查用户的角色权限，比对appId和页面Id的权限是否符合，然后把可操作的模块过滤出来，返回给前端
    - 前端把对应用户的选择发给后端，后端把目标内容状态置为准备状态，进行插入对应的app和页面数据里。
  - 将修改的内容**发布上线**：
    - 如果内容没有设置用户集且第一次发布上线，
    - 如果有配置用户集，需要发送到消息队列处理
    - 对于内容生效时间比当前时间晚的内容的处理，
- C端服务端通过CMS配置的模板对整个APP需要下发的数据进行汇总处理。C端有一个组件处理模块，根据运营所选择配置的组件信息进行不同的处理，将所有组件汇总放到对应页面的items里。
  - 可以对CMS中每一个配置好的组件内容进行处理：匹配用户集，匹配设备，匹配用户个性配置、匹配地区
    - 用户特殊配置的匹配：看看是否有内容需要针对当前请求的用户做特殊处理。
      - 1.**检查是否需要用户特殊配置**。遍历所有内容，先判断组件是否需要用户集匹配（用户集是在配置的时候上传的，根据模块类型和内容id区分缓存在Redis中，在Redis中是以bitmap来存储的）。然后在缓存中查找是否存在用户id或者设备id。如果需要就取出用户集配置。
      - 2.**取用户特殊配置**。根据用户id和设备id从缓存中取，缓存没有从hbase取并加入缓存。
      - 3.根据特殊配置匹配内容是否要加入结果中。
    - 用户状态的匹配：每个content内容可以设置：登录可见、理财新用户可见、贷款新用户可见
    - 设备匹配：
  - 根据需要对用户行为进行收集。
  - 将异步调用的操作位置优化

#### 简要说自己做的两件事

- 新版个人中心接口
  - 对于客户端每个组件的的构成有一部分是服务器端控制的，我的其中一段时间就是做这个新接口
  - 其中个人中心页面的有些组件的数据是客户端再单独去掉另外的接口。包括银行卡数量，用户积分，优惠券数量和具体优惠券数据等。
- 融合项目
  - 我们有一个代码项目是提供客户端页面数据接口的，比如底tab信息，弹窗数据，主页，个人中心啥的，是单提供给小米金融一个app的。现在各业务方要把自己的新app和我们的项目融合，也用我们那一套接口去拿数据，用我们的CMS去配置内容。
  - 这两个项目之前只支持一个APP，当时新需求是**让那几个项目支持多个APP客户端的调用**，用appid来区分。所以对于项目代码中所有涉及到有影响的地方**都要去做支持**。然后不同的APP的需求还不同，又有一些新增的模块，为了让逻辑更简明，所以把负责页面中每个模块的代码都拎出来，组成处理链，每个模块处理逻辑里面去根据参数不同去做处理。之前的业务代码比较直接吧，有一些类里很臃肿，所以也需要我们去对一部分代码做一个简单的重构，也是为了方便支持之后更复杂的需求吧。
    - 具体设计：把分别处理不同模块的代码提取出来，作为**模块处理类**。然后用一个**聚合数据处理结果的一个类**，里面初始化好这些模块处理类，然后根据请求来把从数据库获取的页面的**源数据**，经过整个处理链条去**匹配处理**，每个模块处理类根据自己模块本身的判断来决定是否处理（比如判断app对应的模块类型，根据版本），就是一个责任链的思路。每个请求会把对应请求各种参数数据放到一个新的对象中，作为参数传进去。
    - 具体流程：一个请求app的页面配置信息把从数据库取出来，放到这个模块处理类中，根据整个模块处理链条把每个模块配置数据组装到一起。
  - **数据库表结构也有改动**，除了主键，多app的数据还是存放在之前的表中，某些字段的唯一性有变化了，对于dao层sql就也要去改。因为新的需求，多个页面可以支持相同类型的组件，所以模块信息表的模块类型也不是唯一的了，需要结合pageId去保证查询唯一。
  - 因为**存在不同页面相同模块类型**的情况，模块类型单个字段变成不唯一的，导致**之前的打点信息也要改动**，数据分析那边无法区分一些页面上的模块了，所以这边也要做协调，改成新的打点信息，代码里打点的逻辑还是比较零散，就需要把逻辑提出来。
  - 同时**新增了页面中的一些模块**。写对应的业务代码去组装数据。有一些其他业务方提供的接口的返回结果不满足新需求了，就要协商新的接口的需求。新接入的接口需要去对接密钥，用iauth去做验证。
  - thrift定义的枚举和接口参数和Bean的属性，都要做相应的改动。数据库对应一些写死的数据要去根据不同的需求同步到其他app中。
  - 帮人改bug，同事之前写的有一些问题，测试找出来，然后我就帮他们改
- 其他新需求或者bug处理
  - APP后端
    - 优惠券汇总相关接口有改动
      - 增加新的业务方的优惠券接口
      - 保险的优惠券类型改动，提供所有可用优惠券接口和所有即将过期优惠券接口就需要改动
    - 红点信息缓存相关
      - 增加优惠券即将过期红点信息的缓存
      - 底tab气泡是否展示信息的缓存
  - CMS
    - 模块在页面中的位置可配置
      - 新增可排序模块的表，放一些模块信息，排序位置，是否展示等字段
      - 在APP后端代码里加入处理排序数据的逻辑，对于可排序模块去根据配置的位置做调整
    - 新增用户设备匹配配置
      - 增加了是否为nfc手机的判断逻辑，当然具体客户端传来的参数来判断的，这里主要是写在这个
    - 编辑内容根据权限可以复制到对应其他模块的功能
      - 根据这个moduleinfo中的appid和pageid跟权限去做比对，筛选所有类型一样的模块，然后和前端去做联调
      - 对前端要提供两个接口
        - 提供所有可复制到的目标
        - 对用户所选的目标，做对应数据修改和插入

#### 用到Redis的地方

- 底部tab的气泡：每一次配置气泡内容都会生成一个新的气泡版本。要求每个气泡在未登录情况下每台机器只显示一次，登录情况下每个用户只显示一次。当获取底tab的信息时，会根据用户id，把在Redis缓存的气泡的版本取出来，和当前拿到的版本做比较，如果不相等就表示还有点击（清除），相等就表示不需要气泡数据了；在调用清除气泡的接口后，把redis中对应的气泡版本更新为当前的气泡版本。这样下次就不会加气跑了
- 用户优惠券过期状态：在优惠券整合接口中，如果有快过期优惠券，就把最远的过期时间放到Redis中（相当于优惠券过期状态版本）。把用户优惠券红点状态缓存到Redis（uid，true）。当需要清除红点就把红点状态改为true，当优惠券过期时间有更远的时间时，就需要把红点状态设为true。
- 话题pk模块：话题的左右观点缓存在Redis中。计算对应的比例，组成模块的数据。
  - 提供刷新缓存的服务：把数据库的话题pk信息放入redis



#### 困难

- 理解业务
  - 搞清楚各个功能或者数据的调用关系，出现问题去查日志，去抓包看url找问题源头（有些问题不是报错是数据显示跟预期不符，有些数据是在我们项目里做一个中转）
- 开发流程
  - 这也算是第一次去熟悉整个开发流程。
    - 需求阶段：还要第一次大需求我没在，后来就是看文档跟pm沟通。第二次大需求，就是开会，就直接会上把这个实现难不难，大概思路，大概时间预期和同事就直接沟通一下。
    - 开发阶段：git拉、推、合，代码段junit自测，上测试环境自测
      - junit：之前有写好的Test基类，里面初始化了Spring容器，把项目主要的一些前置工作都做了，比如获取iauth认证啥的
    - 测试阶段：各种jira，有大有小，日常看测试报告，我这边主要就改，也帮导师去改。问题各种各样吧，不一定是啥大的技术问题，基本上都繁琐的小改动，过程中发现问题，需求和代码有时候都需要改。
    - 上线：合代码，review代码，跟导师讲代码，提SQL审批，提上线审批，上线盯着日志。
  - 新增功能
- 第一次上线
  - C端项目中，存在
- 依赖问题
  - 简写：修改提供rpc接口的一个服务和对应的thrift，在增加新的业务类型的优惠券汇总，测试环境
  - 写一个汇总优惠券的接口，这个接口在提供服务的一个服务里。后端的api服务rpc调用这个接口，然后http接口暴露出去。有一个需求是加一个支付业务那边的优惠券。这个枚举是加在thrift里的。测试环境都好着，因为引的依赖都是测试包。线上的api服务的依赖没有更新。
- 依赖冲突
- 历史问题

#### 难点

- 
- 然后就是熟悉业务的过程，我刚来就已经是很需要人手，开始在一知半解的情况下，对新需求的的推进不利
- 刚上线的时候，感觉相对繁琐一些，多个相互调用的项目上线，还涉及到依赖包的改动。
- 我们的项目设计连接了很多其他部门的接口，新版本会发现一些历史问题，之前的负责这系统的老人也不在。需要和不同部门的协调，刚开始对于除了问题是不是全是我们的问题，不是去找谁，要怎么去沟通现在问题，要怎么去协调要搞清楚。

#### 有什么可以改进的地方

- 做了一些和产品没有交流好的功能
- 对于排序功能，我开始跟着做的时候，也在想为什么需要单独把模块的排序字段拆出来做一个新的表，然后表中模块的数据和模块信息表中的数据基本是一一对应的。后来问了当初需求就是说对于一个模块，如果想让他可以显示且可以排序，就通过一个按钮去设置，然后写的逻辑就是去把对应的模块信息的部分字段加上排序相关的字段放在一个新表中。读取数据需要现根据排序表中的模块数据来决定，

#### 实习学到了什么

1. **写业务更熟练**，太复杂的也没交给我。更熟练的去用一些Java8的新特性，比如函数式编程与Map结合减少ifelse。提升了一些查找问题解决问题的能力。之前是没有什么找线上问题的经验。代码量还是有的，熟能生巧
2. **了解了项目开发流程**，包括提交合代码，联调，上线流程，
3. 对于企业开发的大概流程有了了解，体验了一下互联网行业的快节奏工作生活
4. **学会处理人际关系**，有点这个工作的人情世故的经验，然后做事要界限明确。我们部分属于那种偏联系的，接入的部门联系比较多。尽量快速确定关键点，然后问的时候多找几个见证的。
5. 对工作有个一个**更详细的规划**，更好把控自己的工作量，其实是跟学习也是类似的。

 

#### Thrift



#### Hystrix

熔断

给对其他业务提供的http接口的调用配置一些信息，比如超时时间，故障的处理（比如10s内50%出错就熔断5秒，之后放出一部分请求试探）

#### 怎么做沟通



### 博客项目

#### 设计数据库

- 博文表：id，作者id，作者名，标题，摘要，内容，发布标记，访问量，时间，分类id。
- 分类表：id，分类名称，时间
- 标签表：id，标签名称，时间
- 博文-标签表：id，博文id，标签id
- 评论表：id，博文id，用户id，目标评论id

博文表和分类表是多对一的。

博文表和标签表是一对多的。

评论可以划分为：留言和讨论，留言是针对博文的评论，讨论是针对留言的评论

如果是留言，那么评论的目标评论id就为-1。如果是讨论，评论的目标评论id就是可以展开讨论那条留言。

#### 查询

- 查博文带分类带标签：博文和分类是一对多，和标签是多对多。博文和分类用一个sql（博文联表分类表），博文和标签用另一个sql（根据id到博文-标签表中查联表标签表）
- 查对应博文最多的分类：分类和博文表联表，根据分类id分组，count降序
- 查对应博文最多的标签：用子查询查映射表，根据标签id分组，根据count降序。根据这些id去查标签内容
- 查博文的所有留言：根据博文id和目标评论id为-1，查评论数据
- 查留言的所有讨论：根据评论id，查评论数据

#### 排行

在Redis中用zset来存储，score为访问量，value为博文id

每次访问博文内容的接口后，就会做增加访问量的操作。

#### 延时队列

我做了一个定时把保存的博文改成发布的状态。没想去引入别的中间件了，就想着用Redis实现一个简单的定时计划的功能。

实现思路：

- 将整个Redis当做消息池，用这个key作为id，value为自己定义的消息体。
- 用Zset做优先队列，score存储当前时间+时延，来维持优先级，value为消息id
- 去轮询zset，拿出score比当前时间大的数据，删除。
- 根据消息id去取对应的消息。
- 消费成功后，删除对应的优先队列数据和消息数据
- 消费失败，就让消息重回队列

代码：

- 定义消息，包括id、类型、延时时间、数据
- 定义不同消息的hander，针对不同消息做处理的类
- 创建消息消费者，把hander组成责任链，来处理每个消息。处理失败就把优先队列的数据再放到队列中，成功就把消息和队列信息删掉
- 创建消息生产者，负责创建对应的消息，然后到消息池和优先队列中



#### 缓存一致性



MySQL更新同步到Redis

- 我这里用了一个比较简单的办法当对mysql数据做修改时，就对redis中对应的数据删除
- 可以用binlog，用额外的工程做binlog分析和同步

查询博文先到Redis中查找，如果没有会从数据库查更新到缓存中





### 反问

- 面试流程
- 什么部门，主要的业务是什么
- 面试中不会的问题
- 技术栈
- 平时啥工作时间



## 单选题

> 关系代数运算中，五中基本运算为

并、差、交、选择、投影

> 以下关于设计模式的说法中正确的是：D
>
> A. 相对于工厂模式，抽象工厂不需要新的类只需要新的实现
>
> B. 适配器模式和桥接模式都用于兼容已设计的不兼容类的同时工作
>
> C. 观察者模式可用于对不一致状态的目标发送消息
>
> **D. 迭代器模式的实现中通常需要实现空迭代器**





## 概率题

### 1

> 猿辅导公司某研发小组一共有 12 名同学，其中 9 人能做后端开发，6 人能做前端开发。现在要抽调 4 名同学成立项目小组，负责公司的一项“机密”项目。其中 2 名同学做后端开发，2 名同学做前端开发。有多少种选派方法？

(1)只会后端:6个人；

(2)只会前端:3个人；

(3)既会后端又会前端:3个人;

一.从(1)和(2)分别挑两个人，C(2,6)*C(2,3)=15*3=45;

二.从(3)挑1个放前端，有C(1,3)*C(1,3)*C(2,6) = 135;挑一个放后端,有C(1,3)*C(1,6)*C(2,3)=54;

三.从(3)挑2个放前端,有C(2,3)*C(2,6)=45;挑2个放后端,有C(2,3)*C(2,3)=9;1前1后，有C(2,3)*C(1,2)*C(1,3)*C(1,6)=108;

四.从(3)挑2前端,1后端,C(2,3)*C(1,6)=18;1前端,2后端,有C(2,3)*C(1,3)=9;

全部相加:45+135+54+45+9+108+18+9=423



### 2

> 猿辅导公司某部门月会上，有 5 名同学在依次领取入职周年的礼物，一束鲜花。HR 共准备有 5 种不同颜色的鲜花供他们挑选。则有且仅有两名同学挑选了相同颜色的鲜花的概率是多少？

共有5 * 5 * 5 * 5 * 5=3125种情况，每个人可能选的花色有5种

再算有且只有两个人选同一种颜色的情况， 

1.选出两个人C52=10; 

2.选同一种颜色有5种情况; 

3.其他3个人从剩下4种颜色选：4 * 3 * 2=24. 

共有10 * 5 * 24=1200 概率为1200/3125=48/125.

## 智力题

### 扔硬币

> A和B猜每次扔的硬币的正反，猜错的话里一个人继续扔，从A开始，A先猜对的概率为？

2/3

### 两根香

> 两根不均匀的香，每根能燃烧60分钟，现在要精准算出15分钟

想把第一根香的两头，和第二根香的一头点燃。当第一根香烧完时过去了30分钟，第二根香剩下的部分从一边烧能烧30分钟。此时把第二根香的另一边点燃烧完就过去了15分钟

### 两个桶

> A桶容量为5，B桶容量为3

A桶倒满，用A通的水把B倒满，A还剩2的水，把B的水倒掉，把A的2的水倒到B中，B中有2的水。把A灌满，用A的水把B倒满，A就只剩4的水。

### 赛马

> 25匹马，5个跑道，最少需要比赛多少场就能决出前三名

1. 5匹为一组。每组前三名都有可能是前三，剩下的排除，**剩15匹马。赛5场。**
2. 每个小组的第一名放在一起比赛。第一名肯定是第一，排除，**剩14匹马。赛1场。**
3. 2比赛中第一名所在组的二、三名有可能是前三，剩下的排除-2。2比赛中第二名所在组的第二名可能是最后第三名，第三名之后排除-3。2比赛中第三名所在组，除了第一，别的都要排除-4。**剩5匹马**
4. 5匹马正好可以比一次，找出第二名和第三名。**赛1场。**

最少赛5场就可以找出前三。



### 海盗

> 5个海盗分100个金币，如果一个人提出的分配方案得到半数以上（含半数）的统一就执行，否则处死第一个人，再由第二个人提方案。第一个人怎么提方案可以获得最大利益，又不会被处死。每个人都会理性的追求最大利益。

从后向前推

- 假如最后只剩下4和5，此时是4提方案，4肯定会提100，0。这样5肯定拿不到钱，所以他也需要3活着。方案为：100，0。
- 3号提方案时，知道5号只能拿0，所以给5号1来拉拢，5必须接受因为3死了自己只能拿到0。方案为：99，0，1。
- 2号知道3号给4号0，所以给4号1来拉拢。方案为：99，0，1，0。
- 1号知道2号要分给3和50，所以要给3和5分别1来拉拢。方案为：98，0，1，0，1。



### 12小球称重

> 12个小球，其中一个质量不均匀，现有一个无砝码的天平，请问怎么在3次称重内确定有问题的小球？

说先把小球分为三组，每份四个。（1、2、3、4）（5、6、7、8）（9、10、11、12）。拿出前两组放在天平两侧。用C表示正常球。

- 天平平衡：说明这八个小球是正常的。目标球在第三组中（9、10、11、12）。接下来把第三组拿出一个加上三个正常球作为一组放在左边，剩下两个加上两个正常球放在右边。（9、10、11）（C、C、C）
  - 天平平衡：说明12是目标小球
  - 天平一高一低：把左边中两个比较大小。（9）（10）
    - 天平平衡：说明11是目标球。
    - 天平一高一低：在上一步（9、10、11）如果低，这次低的球为目标；如果上一步（9、10、11）高，则这次高的球为目标。
- 天平一高一低：目标在这个8个里面，另外4个是正常的。接下来把天平两边放（1、6、7、8）（5、C、C、C），即把右边的三个替换左边的三个，右边空的三个用正常球补上。
  - 天平平衡：说明目标在（2，3，4）中。接下来天平两边放（2）（3）
    - 天平平衡：4为目标球。
    - 天平一高一低：如果之前（1，2，3，4）所在的边如果高，那么这次高的就是目标球；上次如果低，这次低的为目标球。
  - 天平一高一低：如果上一次左边高，这次也左边高，说明1比较轻；如果上一次左边高，这次右边高，说明目标球在移到左边的三个中（6，7，8）。接下来天平两边各放一个（6）（7）
    - 天平平衡：8为目标球。
    - 一高一低：如果之前（6，7，8）是低的，那这次低的为目标；如果之前（6，7，8）是高的，那这次高的为目标。





## 大数据量（待更新！！！）

